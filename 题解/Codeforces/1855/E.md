这道题首先利用线性性拆分贡献 , 对于每一个 i , 如果 i 的下一个 j 由于碰撞消失了 , 我们可以将被 j 碰撞的位置看做 j 的替身 , 接下来我们将通过一个式子证明步数的转移是没有影响的 .

假设当前剩下的棋子数为 p , `Dp[i][j]` 代表一个棋子在 i , 另一个在 j ,i 的期望步数

$$
Dp[i][j]=\frac{p-2}{p}Dp[i][j]+\frac1p(Dp[i+1][j]+1)+\frac1pDp[i][j+1]
$$

然后通过移项可以发现与 p 无关 . 直接做就可以了. 注意 j=m+1 转移有所不同 . 但是同样与 p 无关.